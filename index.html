<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
</head>
<body>

	<!--
理想情况下我们应该先判断你的设备上是否
有摄像头或相机，但简单起见，我们在这里直接
写出了HTML标记，而不是用JavaScript先判断
然后动态生成这些标记
-->
	<!-- http://blog.csdn.net/qq_16559905/article/details/51743588 -->

	<!-- https://stackoverflow.com/questions/32329484/google-permission-denied-on-current-location -->
<!-- http://www.jb51.net/html5/160919.html -->


	<video id="video" autoplay=""style='width:640px;height:480px'></video>
<button id='picture'>PICTURE</button> 
<canvas id="canvas" width="640" height="480"></canvas>
</body>
<script type="text/javascript">

	var video = document.getElementById("video");
	var canvas = document.getElementById("canvas");
	var context = canvas.getContext("2d")
	var errocb = function () {
	                          console.log('sth wrong!');
	                     }



		navigator.getMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMeddia || navigator.msGetUserMedia;

if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
        navigator.mediaDevices.getUserMedia({
            video: { facingMode: { exact: "environment" }},
            audio: false
        }).then(function(stream) {
            alert(stream);

            mediaStreamTrack = typeof stream.stop === 'function' ? stream : stream.getTracks()[1];

            video.src = (window.URL || window.webkitURL).createObjectURL(stream);
            video.play();
        }).catch(function(err) {
            console.log(err);
        })
    }



// 	  if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
// 	      navigator.mediaDevices.getUserMedia({video: { facingMode: { exact: "environment" } }}).then(function(stream) {
// 	        console.log(stream);
	   
// 	        mediaStreamTrack = typeof stream.stop === 'function' ? stream : stream.getTracks()[1];
// 	   	debugger;
// 	        video.src = (window.URL || window.webkitURL).createObjectURL(stream);
// 	        video.play();
// 	      }).catch(function(err) {
// 	        console.log(err);
// 	      })
// 	    } 


	 document.getElementById("picture").addEventListener("click", function () {

	                 context.drawImage(video, 0, 0, 640, 480);
	  });
</script>
</html>



